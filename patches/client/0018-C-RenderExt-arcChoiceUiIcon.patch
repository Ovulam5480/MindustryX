From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: way-zer <himc.wicp@gmail.com>
Date: Sat, 17 Feb 2024 13:56:18 +0800
Subject: [PATCH] =?UTF-8?q?C(RenderExt)=20arcChoiceUiIcon(=E6=98=BE?=
 =?UTF-8?q?=E7=A4=BA=E9=80=89=E4=B8=AD=E7=89=A9=E5=93=81=E5=9B=BE=E6=A0=87?=
 =?UTF-8?q?)?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 .../world/blocks/distribution/DirectionalUnloader.java      | 2 ++
 .../src/mindustry/world/blocks/distribution/DuctRouter.java | 2 ++
 core/src/mindustry/world/blocks/distribution/Sorter.java    | 2 ++
 core/src/mindustry/world/blocks/sandbox/ItemSource.java     | 2 ++
 core/src/mindustry/world/blocks/storage/Unloader.java       | 6 ++++++
 .../mindustry/world/blocks/units/UnitCargoUnloadPoint.java  | 2 ++
 core/src/mindustryX/features/RenderExt.java                 | 2 ++
 7 files changed, 18 insertions(+)

diff --git a/core/src/mindustry/world/blocks/distribution/DirectionalUnloader.java b/core/src/mindustry/world/blocks/distribution/DirectionalUnloader.java
index 92ccae0e1122e1501ab2d96facb3c0cef5ce8842..e8416d87136fced0e6bc045d93a58be52cb48f31 100644
--- a/core/src/mindustry/world/blocks/distribution/DirectionalUnloader.java
+++ b/core/src/mindustry/world/blocks/distribution/DirectionalUnloader.java
@@ -14,6 +14,7 @@ import mindustry.world.blocks.*;
 import mindustry.world.blocks.storage.CoreBlock.*;
 import mindustry.world.blocks.storage.StorageBlock.*;
 import mindustry.world.meta.*;
+import mindustryX.features.*;
 
 import static mindustry.Vars.*;
 
@@ -122,6 +123,7 @@ public class DirectionalUnloader extends Block{
                 Draw.color(unloadItem.color);
                 Draw.rect(centerRegion, x, y);
                 Draw.color();
+                if(RenderExt.arcChoiceUiIcon) Draw.rect(unloadItem.uiIcon, x, y,4f,4f);
             }else{
                 Draw.rect(arrowRegion, x, y, rotdeg());
             }
diff --git a/core/src/mindustry/world/blocks/distribution/DuctRouter.java b/core/src/mindustry/world/blocks/distribution/DuctRouter.java
index 502915d2887c3a9a9f78fecc2841bbfdaf10cd26..485301ae729ba660a4cad4dba2c2ddc038a23d32 100644
--- a/core/src/mindustry/world/blocks/distribution/DuctRouter.java
+++ b/core/src/mindustry/world/blocks/distribution/DuctRouter.java
@@ -12,6 +12,7 @@ import mindustry.type.*;
 import mindustry.world.*;
 import mindustry.world.blocks.*;
 import mindustry.world.meta.*;
+import mindustryX.features.*;
 
 import static mindustry.Vars.*;
 
@@ -84,6 +85,7 @@ public class DuctRouter extends Block{
                 Draw.color(sortItem.color);
                 Draw.rect("center", x, y);
                 Draw.color();
+                if(RenderExt.arcChoiceUiIcon) Draw.rect(sortItem.uiIcon, x, y,4f,4f);
             }else{
                 Draw.rect(topRegion, x, y, rotdeg());
             }
diff --git a/core/src/mindustry/world/blocks/distribution/Sorter.java b/core/src/mindustry/world/blocks/distribution/Sorter.java
index 805fad17aa2548240be635f75085c158d100fb1f..371a22776d3f569c2a65590ba720432b365cb75b 100644
--- a/core/src/mindustry/world/blocks/distribution/Sorter.java
+++ b/core/src/mindustry/world/blocks/distribution/Sorter.java
@@ -13,6 +13,7 @@ import mindustry.type.*;
 import mindustry.world.*;
 import mindustry.world.blocks.*;
 import mindustry.world.meta.*;
+import mindustryX.features.*;
 
 import static mindustry.Vars.*;
 
@@ -78,6 +79,7 @@ public class Sorter extends Block{
                 Draw.color(sortItem.color);
                 Fill.square(x, y, tilesize/2f - 0.00001f);
                 Draw.color();
+                if(RenderExt.arcChoiceUiIcon) Draw.rect(sortItem.uiIcon, x, y,4f,4f);
             }
 
             super.draw();
diff --git a/core/src/mindustry/world/blocks/sandbox/ItemSource.java b/core/src/mindustry/world/blocks/sandbox/ItemSource.java
index 0a7461a7ec54131d4a81f0a80c3039341f3100d1..fe9bd668c42f121d89ac4defea3c9d8981ca32b6 100644
--- a/core/src/mindustry/world/blocks/sandbox/ItemSource.java
+++ b/core/src/mindustry/world/blocks/sandbox/ItemSource.java
@@ -11,6 +11,7 @@ import mindustry.type.*;
 import mindustry.world.*;
 import mindustry.world.blocks.*;
 import mindustry.world.meta.*;
+import mindustryX.features.*;
 
 import static mindustry.Vars.*;
 
@@ -73,6 +74,7 @@ public class ItemSource extends Block{
                 Draw.color(outputItem.color);
                 Fill.square(x, y, tilesize/2f - 0.00001f);
                 Draw.color();
+                if(RenderExt.arcChoiceUiIcon) Draw.rect(outputItem.uiIcon, x, y,4f,4f);
             }
 
             super.draw();
diff --git a/core/src/mindustry/world/blocks/storage/Unloader.java b/core/src/mindustry/world/blocks/storage/Unloader.java
index a7076762221515ba44b5ca78e7e9a1e37740e0c0..851de302fc1bb2dc8db79059776800d71266cdfa 100644
--- a/core/src/mindustry/world/blocks/storage/Unloader.java
+++ b/core/src/mindustry/world/blocks/storage/Unloader.java
@@ -17,6 +17,8 @@ import mindustry.world.meta.*;
 
 import java.util.*;
 
+import mindustryX.features.*;
+
 import static mindustry.Vars.*;
 
 public class Unloader extends Block{
@@ -217,6 +219,10 @@ public class Unloader extends Block{
         public void draw(){
             super.draw();
 
+            if(RenderExt.arcChoiceUiIcon && sortItem != null){
+                Draw.rect(sortItem.uiIcon, x, y,4f,4f);
+                return;
+            }
             Draw.color(sortItem == null ? Color.clear : sortItem.color);
             Draw.rect(centerRegion, x, y);
             Draw.color();
diff --git a/core/src/mindustry/world/blocks/units/UnitCargoUnloadPoint.java b/core/src/mindustry/world/blocks/units/UnitCargoUnloadPoint.java
index d7a2e02c0d81c1935482c3bbb4edb7b555788a43..b536c4f3fdb6b4d850deae290c9de52417deeb26 100644
--- a/core/src/mindustry/world/blocks/units/UnitCargoUnloadPoint.java
+++ b/core/src/mindustry/world/blocks/units/UnitCargoUnloadPoint.java
@@ -12,6 +12,7 @@ import mindustry.type.*;
 import mindustry.world.*;
 import mindustry.world.blocks.*;
 import mindustry.world.meta.*;
+import mindustryX.features.*;
 
 import static mindustry.Vars.*;
 
@@ -47,6 +48,7 @@ public class UnitCargoUnloadPoint extends Block{
                 Draw.color(item.color);
                 Draw.rect(topRegion, x, y);
                 Draw.color();
+                if(RenderExt.arcChoiceUiIcon) Draw.rect(item.uiIcon, x, y,4f,4f);
             }
         }
 
diff --git a/core/src/mindustryX/features/RenderExt.java b/core/src/mindustryX/features/RenderExt.java
index d3f2cc85070e141fa4a6186f6b24f88cdddcb275..002da2e34c2e3f0afc77f9440f8758c1f43cde6c 100644
--- a/core/src/mindustryX/features/RenderExt.java
+++ b/core/src/mindustryX/features/RenderExt.java
@@ -9,12 +9,14 @@ import mindustry.world.blocks.logic.MessageBlock.*;
 
 public class RenderExt{
     public static boolean bulletShow, showMineBeam, displayAllMessage;
+    public static boolean arcChoiceUiIcon;
 
     public static void init(){
         Events.run(Trigger.preDraw, () -> {
             bulletShow = Core.settings.getBool("bulletShow");
             showMineBeam = Core.settings.getBool("showminebeam");
             displayAllMessage = Core.settings.getBool("displayallmessage");
+            arcChoiceUiIcon = Core.settings.getBool("arcchoiceuiIcon");
         });
         Events.run(Trigger.draw, RenderExt::draw);
     }

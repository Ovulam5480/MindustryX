From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: way-zer <himc.wicp@gmail.com>
Date: Sat, 17 Feb 2024 13:56:18 +0800
Subject: [PATCH] =?UTF-8?q?HR(RenderExt)=20arcChoiceUiIcon(=E6=98=BE?=
 =?UTF-8?q?=E7=A4=BA=E9=80=89=E4=B8=AD=E7=89=A9=E5=93=81=E5=9B=BE=E6=A0=87?=
 =?UTF-8?q?)?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 .../world/blocks/distribution/DirectionalUnloader.java      | 2 ++
 .../src/mindustry/world/blocks/distribution/DuctRouter.java | 2 ++
 core/src/mindustry/world/blocks/distribution/Sorter.java    | 2 ++
 core/src/mindustry/world/blocks/sandbox/ItemSource.java     | 2 ++
 core/src/mindustry/world/blocks/storage/Unloader.java       | 6 ++++++
 .../mindustry/world/blocks/units/UnitCargoUnloadPoint.java  | 2 ++
 6 files changed, 16 insertions(+)

diff --git a/core/src/mindustry/world/blocks/distribution/DirectionalUnloader.java b/core/src/mindustry/world/blocks/distribution/DirectionalUnloader.java
index 92ccae0e1122e1501ab2d96facb3c0cef5ce8842..010404a6f75731b1f9ac504c1d4c55259f082827 100644
--- a/core/src/mindustry/world/blocks/distribution/DirectionalUnloader.java
+++ b/core/src/mindustry/world/blocks/distribution/DirectionalUnloader.java
@@ -14,6 +14,7 @@ import mindustry.world.blocks.*;
 import mindustry.world.blocks.storage.CoreBlock.*;
 import mindustry.world.blocks.storage.StorageBlock.*;
 import mindustry.world.meta.*;
+import mindustryX.features.*;
 
 import static mindustry.Vars.*;
 
@@ -122,6 +123,7 @@ public class DirectionalUnloader extends Block{
                 Draw.color(unloadItem.color);
                 Draw.rect(centerRegion, x, y);
                 Draw.color();
+                if(RenderExt.arcChoiceUiIcon) Draw.rect(unloadItem.fullIcon, x, y,4f,4f);
             }else{
                 Draw.rect(arrowRegion, x, y, rotdeg());
             }
diff --git a/core/src/mindustry/world/blocks/distribution/DuctRouter.java b/core/src/mindustry/world/blocks/distribution/DuctRouter.java
index 502915d2887c3a9a9f78fecc2841bbfdaf10cd26..401f813a015c2b8e313a914c71771ecee49c5ebd 100644
--- a/core/src/mindustry/world/blocks/distribution/DuctRouter.java
+++ b/core/src/mindustry/world/blocks/distribution/DuctRouter.java
@@ -12,6 +12,7 @@ import mindustry.type.*;
 import mindustry.world.*;
 import mindustry.world.blocks.*;
 import mindustry.world.meta.*;
+import mindustryX.features.*;
 
 import static mindustry.Vars.*;
 
@@ -84,6 +85,7 @@ public class DuctRouter extends Block{
                 Draw.color(sortItem.color);
                 Draw.rect("center", x, y);
                 Draw.color();
+                if(RenderExt.arcChoiceUiIcon) Draw.rect(sortItem.fullIcon, x, y,4f,4f);
             }else{
                 Draw.rect(topRegion, x, y, rotdeg());
             }
diff --git a/core/src/mindustry/world/blocks/distribution/Sorter.java b/core/src/mindustry/world/blocks/distribution/Sorter.java
index 805fad17aa2548240be635f75085c158d100fb1f..c63355564e9c1f9419b8911af3f4a454681bac82 100644
--- a/core/src/mindustry/world/blocks/distribution/Sorter.java
+++ b/core/src/mindustry/world/blocks/distribution/Sorter.java
@@ -13,6 +13,7 @@ import mindustry.type.*;
 import mindustry.world.*;
 import mindustry.world.blocks.*;
 import mindustry.world.meta.*;
+import mindustryX.features.*;
 
 import static mindustry.Vars.*;
 
@@ -78,6 +79,7 @@ public class Sorter extends Block{
                 Draw.color(sortItem.color);
                 Fill.square(x, y, tilesize/2f - 0.00001f);
                 Draw.color();
+                if(RenderExt.arcChoiceUiIcon) Draw.rect(sortItem.fullIcon, x, y,4f,4f);
             }
 
             super.draw();
diff --git a/core/src/mindustry/world/blocks/sandbox/ItemSource.java b/core/src/mindustry/world/blocks/sandbox/ItemSource.java
index 0a7461a7ec54131d4a81f0a80c3039341f3100d1..18a282b760a6adb78e21b8625b19ed6072d390df 100644
--- a/core/src/mindustry/world/blocks/sandbox/ItemSource.java
+++ b/core/src/mindustry/world/blocks/sandbox/ItemSource.java
@@ -11,6 +11,7 @@ import mindustry.type.*;
 import mindustry.world.*;
 import mindustry.world.blocks.*;
 import mindustry.world.meta.*;
+import mindustryX.features.*;
 
 import static mindustry.Vars.*;
 
@@ -73,6 +74,7 @@ public class ItemSource extends Block{
                 Draw.color(outputItem.color);
                 Fill.square(x, y, tilesize/2f - 0.00001f);
                 Draw.color();
+                if(RenderExt.arcChoiceUiIcon) Draw.rect(outputItem.fullIcon, x, y,4f,4f);
             }
 
             super.draw();
diff --git a/core/src/mindustry/world/blocks/storage/Unloader.java b/core/src/mindustry/world/blocks/storage/Unloader.java
index a7076762221515ba44b5ca78e7e9a1e37740e0c0..2a7e5df8be9c4a3ba846e60355aa34c5b84f23dd 100644
--- a/core/src/mindustry/world/blocks/storage/Unloader.java
+++ b/core/src/mindustry/world/blocks/storage/Unloader.java
@@ -17,6 +17,8 @@ import mindustry.world.meta.*;
 
 import java.util.*;
 
+import mindustryX.features.*;
+
 import static mindustry.Vars.*;
 
 public class Unloader extends Block{
@@ -217,6 +219,10 @@ public class Unloader extends Block{
         public void draw(){
             super.draw();
 
+            if(RenderExt.arcChoiceUiIcon && sortItem != null){
+                Draw.rect(sortItem.fullIcon, x, y,4f,4f);
+                return;
+            }
             Draw.color(sortItem == null ? Color.clear : sortItem.color);
             Draw.rect(centerRegion, x, y);
             Draw.color();
diff --git a/core/src/mindustry/world/blocks/units/UnitCargoUnloadPoint.java b/core/src/mindustry/world/blocks/units/UnitCargoUnloadPoint.java
index d7a2e02c0d81c1935482c3bbb4edb7b555788a43..3b3e49cca2b424aeddd693d261b5e242cd344913 100644
--- a/core/src/mindustry/world/blocks/units/UnitCargoUnloadPoint.java
+++ b/core/src/mindustry/world/blocks/units/UnitCargoUnloadPoint.java
@@ -12,6 +12,7 @@ import mindustry.type.*;
 import mindustry.world.*;
 import mindustry.world.blocks.*;
 import mindustry.world.meta.*;
+import mindustryX.features.*;
 
 import static mindustry.Vars.*;
 
@@ -47,6 +48,7 @@ public class UnitCargoUnloadPoint extends Block{
                 Draw.color(item.color);
                 Draw.rect(topRegion, x, y);
                 Draw.color();
+                if(RenderExt.arcChoiceUiIcon) Draw.rect(item.fullIcon, x, y,4f,4f);
             }
         }
 

From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: way-zer <himc.wicp@gmail.com>
Date: Sun, 18 Feb 2024 15:57:51 +0800
Subject: [PATCH] C(RenderExt) bulletShow showMineBeam displayAllMessage
 arcTurretPlaceCheck

---
 core/src/mindustry/entities/comp/MinerComp.java       |  2 ++
 .../world/blocks/defense/turrets/BaseTurret.java      |  6 ++++++
 core/src/mindustryX/features/RenderExt.java           | 11 +++++++++++
 3 files changed, 19 insertions(+)

diff --git a/core/src/mindustry/entities/comp/MinerComp.java b/core/src/mindustry/entities/comp/MinerComp.java
index 0e1caeb7283ae45f57c55825affe28a2b644bac0..65a55cc0a5c6601241d7bfc404bd0eaa259dc164 100644
--- a/core/src/mindustry/entities/comp/MinerComp.java
+++ b/core/src/mindustry/entities/comp/MinerComp.java
@@ -12,6 +12,7 @@ import mindustry.graphics.*;
 import mindustry.input.*;
 import mindustry.type.*;
 import mindustry.world.*;
+import mindustryX.features.*;
 
 import static mindustry.Vars.*;
 
@@ -126,6 +127,7 @@ abstract class MinerComp implements Itemsc, Posc, Teamc, Rotc, Drawc{
 
     @Override
     public void draw(){
+        if(!RenderExt.showMineBeam) return;
         if(!mining()) return;
         float focusLen = hitSize / 2f + Mathf.absin(Time.time, 1.1f, 0.5f);
         float swingScl = 12f, swingMag = tilesize / 8f;
diff --git a/core/src/mindustry/world/blocks/defense/turrets/BaseTurret.java b/core/src/mindustry/world/blocks/defense/turrets/BaseTurret.java
index a959c00ba2d01957c499fe3b9447cb200e3bf8e1..60193cd29f30f90ebf58bbe93e621fa71db4fe53 100644
--- a/core/src/mindustry/world/blocks/defense/turrets/BaseTurret.java
+++ b/core/src/mindustry/world/blocks/defense/turrets/BaseTurret.java
@@ -1,5 +1,7 @@
 package mindustry.world.blocks.defense.turrets;
 
+import arc.*;
+import arc.graphics.g2d.*;
 import arc.math.*;
 import arc.struct.*;
 import arc.util.*;
@@ -67,6 +69,10 @@ public class BaseTurret extends Block{
 
         Drawf.dashCircle(x * tilesize + offset, y * tilesize + offset, range, Pal.placing);
 
+        if(state.rules.placeRangeCheck && Core.settings.getBool("arcTurretPlaceCheck")){
+            Draw.alpha(0.5f);
+            Drawf.dashCircle(x * tilesize + offset, y * tilesize + offset, placeOverlapRange, Pal.remove);
+        }
         if(fogRadiusMultiplier < 0.99f && state.rules.fog){
             Drawf.dashCircle(x * tilesize + offset, y * tilesize + offset, range * fogRadiusMultiplier, Pal.lightishGray);
         }
diff --git a/core/src/mindustryX/features/RenderExt.java b/core/src/mindustryX/features/RenderExt.java
index 835b5d7b801f03683cbb7502ea98025ff2c24d40..c0fe214232b848835a30a51ac3c0904366858bd3 100644
--- a/core/src/mindustryX/features/RenderExt.java
+++ b/core/src/mindustryX/features/RenderExt.java
@@ -1,14 +1,22 @@
 package mindustryX.features;
 
 import arc.*;
+import arc.graphics.g2d.*;
 import arc.util.*;
 import mindustry.game.EventType.*;
 import mindustry.gen.*;
+import mindustry.graphics.*;
 import mindustry.world.*;
+import mindustry.world.blocks.logic.MessageBlock.*;
 
 public class RenderExt{
+    public static boolean bulletShow, showMineBeam, displayAllMessage;
+
     public static void init(){
         Events.run(Trigger.preDraw, () -> {
+            bulletShow = Core.settings.getBool("bulletShow");
+            showMineBeam = Core.settings.getBool("showminebeam");
+            displayAllMessage = Core.settings.getBool("displayallmessage");
         });
         Events.run(Trigger.draw, RenderExt::draw);
     }
@@ -18,10 +26,13 @@ public class RenderExt{
     }
 
     public static void onGroupDraw(Drawc t){
+        if(!bulletShow && t instanceof Bulletc) return;
         t.draw();
     }
 
     public static void onBlockDraw(Tile tile, Block block, @Nullable Building build){
         block.drawBase(tile);
+        if(displayAllMessage && build instanceof MessageBuild)
+            Draw.draw(Layer.overlayUI - 0.1f, build::drawSelect);
     }
 }

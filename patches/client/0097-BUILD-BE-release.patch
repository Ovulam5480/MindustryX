From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: way-zer <himc.wicp@gmail.com>
Date: Wed, 3 Jul 2024 00:16:15 +0800
Subject: [PATCH] BUILD BE release

---
 .github/workflows/build.yml                     |  6 ++++--
 .github/workflows/gradle-wrapper-validation.yml | 10 ----------
 gradle.properties                               |  3 ++-
 3 files changed, 6 insertions(+), 13 deletions(-)
 delete mode 100644 .github/workflows/gradle-wrapper-validation.yml

diff --git a/.github/workflows/build.yml b/.github/workflows/build.yml
index 797925569a7a81a34dff17296884a7088e05d5f1..04d360717113342650e43a37cc3b541376a1d3d6 100644
--- a/.github/workflows/build.yml
+++ b/.github/workflows/build.yml
@@ -34,16 +34,18 @@ jobs:
           echo "${{ secrets.KEYSTORE_BASE64 }}" | openssl enc -d -base64 -in - -out ../bekeystore.jks
       - name: Build
         run: |
-          gradle desktop:dist core:genLoaderModAll -Pbuildversion=${RELEASE_VERSION}
+          gradle desktop:dist server:dist -Pbuildversion=${RELEASE_VERSION}
           mkdir artifacts
           mv desktop/build/libs/Mindustry.jar artifacts/MindustryX-${{env.RELEASE_VERSION}}-Desktop.jar
-          mv core/build/distributions/MindustryX.loader.dex.jar artifacts/MindustryX-${{env.RELEASE_VERSION}}.loader.dex.jar
+          mv server/build/libs/server-release.jar artifacts/server-${{env.RELEASE_VERSION}}.jar
       - name: Build Android
         env:
           keystore_password: ${{ secrets.KEYSTORE_PASSWORD_SECRET }}
           keystore_alias_password: ${{ secrets.KEYSTORE_PASSWORD_SECRET }}
           keystore_alias: MindustryX
         run: |
+          sed -i 's/tinylake.mindustryX/tinylake.mindustryX.be/g' android/build.gradle
+          sed -i 's/MindustryX/MindustryX BE/g' android/res/values/strings.xml
           gradle android:assembleRelease -Pbuildversion=${RELEASE_VERSION}
           mv android/build/outputs/apk/release/android-release.apk artifacts/MindustryX-${{env.RELEASE_VERSION}}-Android.apk
       - name: Update Tag
diff --git a/.github/workflows/gradle-wrapper-validation.yml b/.github/workflows/gradle-wrapper-validation.yml
deleted file mode 100644
index 95cce8bab650b7357a7b675ea34c04601a1ec66a..0000000000000000000000000000000000000000
--- a/.github/workflows/gradle-wrapper-validation.yml
+++ /dev/null
@@ -1,10 +0,0 @@
-name: "Validate Gradle Wrapper"
-on: [push, pull_request]
-
-jobs:
-  validation:
-    name: "Validation"
-    runs-on: ubuntu-latest
-    steps:
-      - uses: actions/checkout@v4
-      - uses: gradle/wrapper-validation-action@v2
diff --git a/gradle.properties b/gradle.properties
index 27667713782de440711293558d22979f28458fe0..0447c5af5adeec02d0738a506c1e2cda0aced33e 100644
--- a/gradle.properties
+++ b/gradle.properties
@@ -28,4 +28,5 @@ org.gradle.internal.http.connectionTimeout=100000
 android.enableR8.fullMode=false
 archash=6676d38433
 
-upstreamBuild=25162
\ No newline at end of file
+upstreamBuild=25162
+versionType=bleeding-edge
\ No newline at end of file

From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: way-zer <himc.wicp@gmail.com>
Date: Wed, 3 Apr 2024 21:25:13 +0800
Subject: [PATCH] =?UTF-8?q?FC:=20=E5=B0=8F=E5=9C=B0=E5=9B=BE=E5=A4=A7?=
 =?UTF-8?q?=E5=B0=8F=E5=8F=AF=E8=B0=83?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 core/src/mindustry/ui/Minimap.java | 18 ++++++++++++------
 1 file changed, 12 insertions(+), 6 deletions(-)

diff --git a/core/src/mindustry/ui/Minimap.java b/core/src/mindustry/ui/Minimap.java
index ad828a8dd2394d2c9759e215ebc0d91945357409..770b034943c7a043d50f6191b8d3b6df4e228196 100644
--- a/core/src/mindustry/ui/Minimap.java
+++ b/core/src/mindustry/ui/Minimap.java
@@ -11,24 +11,30 @@ import mindustry.gen.*;
 import static mindustry.Vars.*;
 
 public class Minimap extends Table{
+    private final Cell<?> mapCell;
 
     public Minimap(){
         background(Tex.pane);
         float margin = 5f;
         this.touchable = Touchable.enabled;
 
-        add(new Element(){
-            {
-                setSize(Scl.scl(140f));
-            }
-
+        mapCell = add(new Element(){
             @Override
             public void act(float delta){
+                var size = Core.settings.getInt("minimapSize");
+                mapCell.size(size);
+                setSize(Scl.scl(size));
                 setPosition(Scl.scl(margin), Scl.scl(margin));
 
                 super.act(delta);
             }
 
+            @Override
+            protected void sizeChanged(){
+                super.sizeChanged();
+                mapCell.getTable().invalidate();
+            }
+
             @Override
             public void draw(){
                 if(renderer.minimap.getRegion() == null) return;
@@ -38,7 +44,7 @@ public class Minimap extends Table{
 
                 if(renderer.minimap.getTexture() != null){
                     Draw.alpha(parentAlpha);
-                    renderer.minimap.drawEntities(x, y, width, height, 0.75f, false);
+                    renderer.minimap.drawEntities(x, y, width, height, 3f / renderer.minimap.getZoom(), false);
                 }
 
                 clipEnd();

From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: way-zer <himc.wicp@gmail.com>
Date: Fri, 23 Feb 2024 01:05:54 +0800
Subject: [PATCH] API: Hooks.onHandleSendMessage

---
 core/src/mindustry/core/NetClient.java | 4 ++++
 core/src/mindustryX/Hooks.java         | 6 ++++++
 2 files changed, 10 insertions(+)

diff --git a/core/src/mindustry/core/NetClient.java b/core/src/mindustry/core/NetClient.java
index 6eaa704296d197c2bcd722c78e2c770a543aec27..dcca3b910e100d508955cf96681a793f6055f114 100644
--- a/core/src/mindustry/core/NetClient.java
+++ b/core/src/mindustry/core/NetClient.java
@@ -198,6 +198,8 @@ public class NetClient implements ApplicationListener{
 
     @Remote(targets = Loc.server, variants = Variant.both)
     public static void sendMessage(String message, @Nullable String unformatted, @Nullable Player playersender){
+        message = mindustryX.Hooks.onHandleSendMessage(message, playersender);
+        if(message == null) return;
         if(Vars.ui != null){
             Vars.ui.chatfrag.addMessage(message);
             Sounds.chatMessage.play();
@@ -215,6 +217,8 @@ public class NetClient implements ApplicationListener{
     //equivalent to above method but there's no sender and no console log
     @Remote(called = Loc.server, targets = Loc.server)
     public static void sendMessage(String message){
+        message = mindustryX.Hooks.onHandleSendMessage(message, null);
+        if(message == null) return;
         if(Vars.ui != null){
             Vars.ui.chatfrag.addMessage(message);
             Sounds.chatMessage.play();
diff --git a/core/src/mindustryX/Hooks.java b/core/src/mindustryX/Hooks.java
index c399832fd28e50e3f6464380fca916cf5539d213..8e17b92678d8f8a844dc0395af6cbefbc20ca70e 100644
--- a/core/src/mindustryX/Hooks.java
+++ b/core/src/mindustryX/Hooks.java
@@ -3,6 +3,7 @@ package mindustryX;
 import arc.*;
 import arc.util.*;
 import mindustry.*;
+import mindustry.gen.*;
 import mindustryX.features.*;
 
 import java.net.*;
@@ -31,4 +32,9 @@ public class Hooks implements ApplicationListener{
             }
         }
     }
+
+    public static @Nullable String onHandleSendMessage(String message, @Nullable Player sender){
+        if(message == null) return null;
+        return message;
+    }
 }
